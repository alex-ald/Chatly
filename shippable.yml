build_image: node
language:
  - node_js
node_js:
  - "4.6.0"
branches:
  only:
    - master
    - qa
before_install:
  - apt-get install -y python-dev
  - pip install awsebcli
install:
  - npm install
before_script:
  - mkdir -p ~/.aws
  - echo '[profile eb-cli]' > ~/.aws/config
  - echo "aws_access_key_id = $AWSAccessKeyId" >> ~/.aws/config
  - echo "aws_secret_access_key = $AWSSecretKey" >> ~/.aws/config
script:
  - npm test
commit_container: alexald/chatly
after_success:
  - eb init && eb deploy --timeout 20
notifications:
  email: false
