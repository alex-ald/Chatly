# Language settings
language: node_js

branches:
  only:
    - QA
    - master

build:
  ci:
    - echo 'CI is running'

  post_ci:
      # Addresses botocore version mismatch errors
      - pip install --upgrade botocore

integrations:
  deploy:
    # AWS Integration to deploy Docker image - to QA
    - integrationName: "AWS"
      type: aws
      application_name: "Chatly"
      branches:
        only:
          - QA
      env_name: chatly--qa
      region: "us-east-1"
      image_name: "alexald/chatly-app"
      image_tag: "$BRANCH.$BUILD_NUMBER"

    # AWS Integration to deploy Docker image - to PROD
    - integrationName: "AWS-KS"
      type: aws
      application_name: "Kdispatch"
      branches:
        only:
          - master
      env_name: kdispatch-prod-env
      region: "us-west-2"
      image_name: "kdispatch-app"
      image_tag: "$BRANCH.$BUILD_NUMBER"
